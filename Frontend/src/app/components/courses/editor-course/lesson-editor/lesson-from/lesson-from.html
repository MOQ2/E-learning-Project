<div class="lesson-form" [formGroup]="lessonForm">
  <div class="form-sections-wrapper">
    <section class="card">
      <h2 class="card-title">Lesson details</h2>
      <div class="form-grid">

        <div class="form-group full-width">
          <label for="lesson-title">Title (max 250 chars)</label>
          <input type="text" id="lesson-title" class="form-control" formControlName="title">
          <div *ngIf="lessonForm.get('title')?.invalid && lessonForm.get('title')?.touched" class="error-message">
            <span *ngIf="lessonForm.get('title')?.errors?.['required']">Title is required.</span>
            <span *ngIf="lessonForm.get('title')?.errors?.['minlength']">Title must be at least 3 characters.</span>
          </div>
        </div>

        <div class="form-group full-width">
          <label for="lesson-explanation">Explanation (rich text)</label>
          <div class="rich-text-editor">
            <div class="toolbar">
              <button type="button">H1</button>
              <button type="button">H2</button>
              <button type="button">Bold</button>
              <button type="button">Italic</button>
              <button type="button">Quote</button>
            </div>
            <textarea id="lesson-explanation" class="form-control" rows="5" formControlName="explanation"></textarea>
          </div>
          <div *ngIf="lessonForm.get('explanation')?.invalid && lessonForm.get('explanation')?.touched" class="error-message">
            <span *ngIf="lessonForm.get('explanation')?.errors?.['required']">Explanation is required.</span>
            <span *ngIf="lessonForm.get('explanation')?.errors?.['minlength']">Explanation must be at least 10 characters.</span>
          </div>
        </div>

        <div class="form-group full-width">
          <label>What We Will Learn (bullet points)</label>
          <div class="scrollable-list" formArrayName="whatWeWillLearn">
            <ol class="bullet-list numbered-list" start="3">
              <li *ngFor="let item of whatWeWillLearnControls; let i = index">
                <input type="text" class="form-control" [formControlName]="i">
                <button type="button" class="btn-remove" (click)="removeBullet('whatWeWillLearn', i)">Remove</button>
              </li>
            </ol>
          </div>
          <div *ngIf="lessonForm.get('whatWeWillLearn')?.invalid && lessonForm.get('whatWeWillLearn')?.touched" class="error-message">
            At least one bullet point is required.
          </div>
          <button type="button" class="btn-add" (click)="addBullet('whatWeWillLearn')">+ Add bullet</button>
        </div>

        <div class="form-group">
          <label for="video-data">Video Data (only one)</label>
          <input type="file" id="video-data" class="form-control file-input" placeholder="Upload video file">
        </div>

        <div class="form-group">
          <label for="thumbnail-data">Thumbnail Data (only one)</label>
          <input type="file" id="thumbnail-data" class="form-control file-input" placeholder="Upload thumbnail image">
        </div>

        <div class="form-group">
          <label for="duration">Duration (in minutes)</label>
          <input type="number" id="duration" class="form-control" placeholder="e.g., 16" formControlName="duration">
          <div *ngIf="lessonForm.get('duration')?.invalid && lessonForm.get('duration')?.touched" class="error-message">
            <span *ngIf="lessonForm.get('duration')?.errors?.['required']">Duration is required.</span>
            <span *ngIf="lessonForm.get('duration')?.errors?.['min']">Duration must be at least 1 minute.</span>
          </div>
        </div>

        <div class="form-group">
          <label>Status</label>
          <div class="status-toggle">
            <input type="radio" id="status-inactive" value="Inactive" formControlName="status">
            <label for="status-inactive" class="btn tag">Inactive</label>

            <input type="radio" id="status-active" value="Active" formControlName="status">
            <label for="status-active" class="btn tag">Active</label>
          </div>
        </div>

        <div class="form-group full-width">
          <label>Prerequisites (bullet points)</label>
          <div class="scrollable-list" formArrayName="prerequisites">
            <ul class="bullet-list">
              <li *ngFor="let item of prerequisitesControls; let i = index">
                <input type="text" class="form-control" [formControlName]="i">
                <button type="button" class="btn-remove" (click)="removeBullet('prerequisites', i)">Remove</button>
              </li>
            </ul>
          </div>
          <div *ngIf="lessonForm.get('prerequisites')?.invalid && lessonForm.get('prerequisites')?.touched" class="error-message">
            At least one prerequisite is required.
          </div>
          <button type="button" class="btn-add" (click)="addBullet('prerequisites')">+ Add prerequisite</button>
        </div>

      </div>
    </section>

    <section class="card">
      <h2 class="card-title">Attachments</h2>
      <div class="attachment-list scrollable-list" formArrayName="attachments">
        <div class="attachment-item" *ngFor="let attachment of attachments.controls; let i = index" [formGroupName]="i">
          <input type="file" class="form-control file-input" (change)="onFileSelected($event, i)">
          <input type="text" class="form-control" placeholder="Display name" formControlName="displayName">
          <button type="button" class="btn-remove" (click)="removeAttachment(i)">Remove</button>
        </div>
      </div>
      <button type="button" class="btn-add" (click)="addAttachment()">+ Add attachment</button>
    </section>

  </div>
</div>
