<!-- Search Button Trigger -->
<div style="display: inline-block;">
  <button class="search-trigger-btn" (click)="openSearch()" *ngIf="!isOpen" type="button">
    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="11" cy="11" r="8"></circle>
      <path d="m21 21-4.35-4.35"></path>
    </svg>
    Search
  </button>
</div>

<!-- Search Overlay -->
<div class="search-overlay" *ngIf="isOpen" (click)="closeSearch()"></div>

<!-- Search Bar Container -->
<div class="searchbar-container" *ngIf="isOpen">
  <div class="searchbar-content">
    <!-- Search Input Section -->
    <div class="search-header">
      <div class="search-input-wrapper">
        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <input
          type="text"
          class="search-input"
          placeholder="Search courses, instructors..."
          [(ngModel)]="searchQuery"
          (input)="onSearchInput($event)"
          autocomplete="off"
        />
      </div>
      <div class="esc-button">
        <span>Esc</span>
      </div>
    </div>

    <!-- Results Section -->
    <div class="search-results" *ngIf="searchQuery.trim().length > 0">
      <!-- Loading State -->
      <div class="loading-state" *ngIf="isLoading">
        <div class="spinner"></div>
        <p>Searching...</p>
      </div>

      <!-- Results List -->
      <div class="results-container" *ngIf="!isLoading && searchResults.length > 0">
        <div class="results-list">
          <div
            *ngFor="let course of searchResults; let i = index"
            class="result-card"
            [class.selected]="i === selectedIndex"
            (click)="navigateToCourse(course.id)"
          >
            <img
              [src]="course.thumbnailUrl || '/mortarboard_1940690.png'"
              [alt]="course.name"
              class="course-thumbnail"
            />
            <div class="course-info">
              <div class="course-title-section">
                <h3 class="course-title">{{ course.name }}</h3>
              </div>
              <div class="course-meta">
                <span class="meta-item">Course</span>
                <span class="meta-separator">•</span>
                <span class="meta-item">{{ course.lessonCount || 0 }} lessons</span>
                <span class="meta-separator">•</span>
                <span class="meta-item">by {{ course.instructor }}</span>
              </div>
            </div>
            <div class="action-button">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="9 18 15 12 9 6"></polyline>
              </svg>
              <span>View</span>
            </div>
          </div>
        </div>

        <!-- Quick Filters Sidebar -->
        <div class="quick-filters">
          <div class="filters-header">
            <span>Quick filters</span>
          </div>
          <div class="filter-buttons">
            <button
              class="filter-btn"
              [class.active]="activeFilter === 'courses' || activeFilter === 'all'"
              (click)="setFilter('courses'); $event.stopPropagation()"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
              </svg>
              <span>Courses</span>
            </button>
            <button
              class="filter-btn"
              [class.active]="activeFilter === 'instructors'"
              (click)="setFilter('instructors'); $event.stopPropagation()"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
              <span>Instructors</span>
            </button>
            <button
              class="filter-btn"
              [class.active]="activeFilter === 'short'"
              (click)="setFilter('short'); $event.stopPropagation()"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
              <span>&lt; 2 hours</span>
            </button>
            <button
              class="filter-btn"
              [class.active]="activeFilter === 'popular'"
              (click)="setFilter('popular'); $event.stopPropagation()"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
              </svg>
              <span>Popular</span>
            </button>
          </div>
        </div>
      </div>

      <!-- No Results -->
      <div class="no-results" *ngIf="!isLoading && searchResults.length === 0">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <p>No courses found for "{{ searchQuery }}"</p>
        <span>Try different keywords or browse our catalog</span>
      </div>
    </div>

    <!-- Footer -->
    <div class="search-footer">
      <div class="footer-left">
        <div class="footer-hint">
          <span>Enter to open</span>
        </div>
        <div class="footer-hint">
          <span>Tab to navigate</span>
        </div>
      </div>
      <div class="footer-right">
        <span>Use keywords like "React beginner", "Python", "data viz"</span>
      </div>
    </div>
  </div>
</div>
